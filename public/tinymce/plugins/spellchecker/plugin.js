(function(L){function M(a){return a&&1===a.nodeType&&"false"===a.contentEditable}var E=function(a){var b=a;return{get:function(){return b},set:function(e){b=e},clone:function(){return E(b)}}},T=tinymce.util.Tools.resolve("tinymce.PluginManager"),ca={hasProPlugin:function(a){return/(^|[ ,])tinymcespellchecker([, ]|$)/.test(a.settings.plugins)&&T.get("tinymcespellchecker")?("undefined"!==typeof L.window.console&&L.window.console.log&&L.window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),
!0):!1}},B=tinymce.util.Tools.resolve("tinymce.util.Tools"),da=tinymce.util.Tools.resolve("tinymce.util.URI"),ea=tinymce.util.Tools.resolve("tinymce.util.XHR"),U={fireSpellcheckStart:function(a){return a.fire("SpellcheckStart")},fireSpellcheckEnd:function(a){return a.fire("SpellcheckEnd")}},C={getLanguages:function(a){return a.getParam("spellchecker_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")},getLanguage:function(a){var b=
a.getParam("language","en");return a.getParam("spellchecker_language",b)},getRpcUrl:function(a){return a.getParam("spellchecker_rpc_url")},getSpellcheckerCallback:function(a){return a.getParam("spellchecker_callback")},getSpellcheckerWordcharPattern:function(a){return a.getParam("spellchecker_wordchar_pattern",/[^\s!"#$%&()*+,-./:;<=>?@[\]^_{|}`\u00a7\u00a9\u00ab\u00ae\u00b1\u00b6\u00b7\u00b8\u00bb\u00bc\u00bd\u00be\u00bf\u00d7\u00f7\u00a4\u201d\u201c\u201e\u00a0\u2002\u2003\u2009]+/g)}},ha=function(a,
b){function e(c,f){if(!c[0])throw Error("findAndReplaceDOMText cannot handle zero-length matches");return{start:c.index,end:c.index+c[0].length,text:c[0],data:f}}function d(c){if(3===c.nodeType)return c.data;if(V[c.nodeName]&&!H[c.nodeName])return"";if(M(c))return"\n";var f="";if(H[c.nodeName]||W[c.nodeName])f+="\n";if(c=c.firstChild){do f+=d(c);while(c=c.nextSibling)}return f}function g(c,f,h){var m=[],p=0,l=c,z=0;f=f.slice(0);f.sort(function(N,fa){return N.start-fa.start});var r=f.shift();a:for(;;){(H[l.nodeName]||
W[l.nodeName]||M(l))&&p++;if(3===l.nodeType){if(!x&&l.length+p>=r.end){var x=l;var I=r.end-p}else D&&m.push(l);if(!D&&l.length+p>r.start){var D=l;var F=r.start-p}p+=l.length}if(D&&x){if(l=h({startNode:D,startNodeIndex:F,endNode:x,endNodeIndex:I,innerNodes:m,match:r.text,matchIndex:z}),p-=x.length-I,x=D=null,m=[],r=f.shift(),z++,!r)break}else if((!V[l.nodeName]||H[l.nodeName])&&l.firstChild){if(!M(l)){l=l.firstChild;continue}}else if(l.nextSibling){l=l.nextSibling;continue}for(;;)if(l.nextSibling){l=
l.nextSibling;break}else if(l.parentNode!==c)l=l.parentNode;else break a}}function q(c){function f(h,m){var p=v[m];p.stencil||(p.stencil=c(p));p=p.stencil.cloneNode(!1);p.setAttribute("data-mce-index",m);h&&p.appendChild(X.doc.createTextNode(h));return p}return function(h){var m=h.startNode,p=h.endNode,l=h.matchIndex;var z=X.doc;if(m===p){var r=m.parentNode;if(0<h.startNodeIndex){var x=z.createTextNode(m.data.substring(0,h.startNodeIndex));r.insertBefore(x,m)}x=f(h.match,l);r.insertBefore(x,m);h.endNodeIndex<
m.length&&(z=z.createTextNode(m.data.substring(h.endNodeIndex)),r.insertBefore(z,m));m.parentNode.removeChild(m);return x}x=z.createTextNode(m.data.substring(0,h.startNodeIndex));z=z.createTextNode(p.data.substring(h.endNodeIndex));var I=f(m.data.substring(h.startNodeIndex),l);r=0;for(var D=h.innerNodes.length;r<D;++r){var F=h.innerNodes[r],N=f(F.data,l);F.parentNode.replaceChild(N,F)}h=f(p.data.substring(0,h.endNodeIndex),l);r=m.parentNode;r.insertBefore(x,m);r.insertBefore(I,m);r.removeChild(m);
r=p.parentNode;r.insertBefore(h,p);r.insertBefore(z,p);r.removeChild(p);return h}}function k(c){var f=a.getElementsByTagName("*"),h=[];c="number"===typeof c?""+c:null;for(var m=0;m<f.length;m++){var p=f[m],l=p.getAttribute("data-mce-index");null!==l&&l.length&&-1!==p.className.indexOf("mce-spellchecker-word")&&(l===c||null===c)&&h.push(p)}return h}function n(c){for(var f=v.length;f--;)if(v[f]===c)return f;return-1}function t(c){for(var f=0,h=v.length;f<h&&!1!==c(v[f],f);f++);return this}function u(c){var f=
k(c?n(c):null);for(c=f.length;c--;){for(var h=f[c],m=h.parentNode;0<h.childNodes.length;)m.insertBefore(h.childNodes[0],h);m.removeChild(h)}return this}function w(c){c=k(n(c));var f=b.dom.createRng();f.setStartBefore(c[0]);f.setEndAfter(c[c.length-1]);return f}var y,v=[],X=b.dom;var H=b.schema.getBlockElements();var V=b.schema.getWhiteSpaceElements();var W=b.schema.getShortEndedElements();var J=d(a);return{text:J,matches:v,each:t,filter:function(c){var f=[];t(function(h,m){c(h,m)&&f.push(h)});v=f;
return this},reset:function(){v.splice(0,v.length);u();return this},matchFromElement:function(c){return v[c.getAttribute("data-mce-index")]},elementFromMatch:function(c){return k(n(c))[0]},find:function(c,f){if(J&&c.global)for(;y=c.exec(J);)v.push(e(y,f));return this},add:function(c,f,h){v.push({start:c,end:c+f,text:J.substr(c,f),data:h});return this},wrap:function(c){v.length&&g(a,v,q(c));return this},unwrap:u,replace:function(c,f){c=w(c);c.deleteContents();0<f.length&&c.insertNode(b.dom.doc.createTextNode(f));
return c},rangeFromMatch:w,indexOf:n}},ia=function(){},G=function(a){return function(){return a}},O=G(!1),Y=G(!0),P=function(){return ja},ja=function(){var a=function(d){return d.isNone()},b=function(d){return d()},e=function(d){return d};a={fold:function(d,g){return d()},is:O,isSome:O,isNone:Y,getOr:e,getOrThunk:b,getOrDie:function(d){throw Error(d||"error: getOrDie called on none.");},getOrNull:G(null),getOrUndefined:G(void 0),or:e,orThunk:b,map:P,each:ia,bind:P,exists:O,forall:Y,filter:P,equals:a,
equals_:a,toArray:function(){return[]},toString:G("none()")};Object.freeze&&Object.freeze(a);return a}(),ka=Object.hasOwnProperty,la=function(a){for(var b in a)if(ka.call(a,b))return!1;return!0},Q=function(a,b){b.get()||(a=ha(a.getBody(),a),b.set(a));return b.get()},ma=function(a,b,e){return function(d,g,q,k){var n={method:d,lang:e.get()},t="";n["addToDictionary"===d?"word":"text"]=g;B.each(n,function(u,w){t&&(t+="&");t+=w+"="+encodeURIComponent(u)});ea.send({url:(new da(b)).toAbsolute(C.getRpcUrl(a)),
type:"post",content_type:"application/x-www-form-urlencoded",data:t,success:function(u){(u=JSON.parse(u))?u.error?k(u.error):q(u):(u=a.translate("Server response wasn't proper JSON."),k(u))},error:function(){var u=a.translate("The spelling service was not found: (")+C.getRpcUrl(a)+a.translate(")");k(u)}})}},Z=function(a,b,e,d,g,q,k){var n=C.getSpellcheckerCallback(a);(n?n:ma(a,b,e)).call(a.plugins.spellchecker,d,g,q,k)},S=function(a,b,e){a.dom.select("span.mce-spellchecker-word").length||R(a,b,e)},
R=function(a,b,e){var d=a.selection.getBookmark();Q(a,e).reset();a.selection.moveToBookmark(d);e.set(null);if(b.get())return b.set(!1),U.fireSpellcheckEnd(a),!0},aa=function(a){a=a.getAttribute("data-mce-index");return"number"===typeof a?""+a:a},ba=function(a,b,e,d,g){var q=!!g.dictionary,k=g.words;a.setProgressState(!1);la(k)?(e=a.translate("No misspellings found."),a.notificationManager.open({text:e,type:"info"}),b.set(!1)):(d.set({suggestions:k,hasDictionarySupport:q}),d=a.selection.getBookmark(),
Q(a,e).find(C.getSpellcheckerWordcharPattern(a)).filter(function(n){return!!k[n.text]}).wrap(function(n){return a.dom.create("span",{"class":"mce-spellchecker-word","aria-invalid":"spelling","data-mce-bogus":1,"data-mce-word":n.text})}),a.selection.moveToBookmark(d),b.set(!0),U.fireSpellcheckStart(a))},A={spellcheck:function(a,b,e,d,g,q){R(a,e,d)||(a.setProgressState(!0),Z(a,b,q,"spellcheck",Q(a,d).text,function(k){ba(a,e,d,g,k)},function(k){a.notificationManager.open({text:k,type:"error"});a.setProgressState(!1);
R(a,e,d)}),a.focus())},checkIfFinished:S,addToDictionary:function(a,b,e,d,g,q,k){a.setProgressState(!0);Z(a,b,g,"addToDictionary",q,function(){a.setProgressState(!1);a.dom.remove(k,!0);S(a,e,d)},function(n){a.notificationManager.open({text:n,type:"error"});a.setProgressState(!1)})},ignoreWord:function(a,b,e,d,g,q){a.selection.collapse();q?B.each(a.dom.select("span.mce-spellchecker-word"),function(k){k.getAttribute("data-mce-word")===d&&a.dom.remove(k,!0)}):a.dom.remove(g,!0);S(a,b,e)},findSpansByIndex:function(a,
b){var e=[];a=B.toArray(a.getBody().getElementsByTagName("span"));if(a.length)for(var d=0;d<a.length;d++){var g=aa(a[d]);null!==g&&g.length&&g===b.toString()&&e.push(a[d])}return e},getElmIndex:aa,markErrors:ba},na={get:function(a,b,e,d,g,q){return{getTextMatcher:function(){return d.get()},getWordCharPattern:function(){return C.getSpellcheckerWordcharPattern(a)},markErrors:function(k){A.markErrors(a,b,d,e,k)},getLanguage:function(){return g.get()}}}},oa={register:function(a,b,e,d,g,q){a.addCommand("mceSpellCheck",
function(){A.spellcheck(a,b,e,d,g,q)})}},K=function(){K=Object.assign||function(a){for(var b,e=1,d=arguments.length;e<d;e++){b=arguments[e];for(var g in b)Object.prototype.hasOwnProperty.call(b,g)&&(a[g]=b[g])}return a};return K.apply(this,arguments)},pa=function(a,b){var e=[];B.each(b,function(d){e.push({selectable:!0,text:d.name,data:d.value})});return e},qa=function(a){return B.map(C.getLanguages(a).split(","),function(b){b=b.split("=");return{name:b[0],value:b[1]}})},ra={register:function(a,b,
e,d,g,q){var k=pa("Language",qa(a)),n=function(){A.spellcheck(a,b,e,d,q,g)},t={tooltip:"Spellcheck",onAction:n,icon:"spell-check",onSetup:function(w){var y=function(){w.setActive(e.get())};a.on("SpellcheckStart SpellcheckEnd",y);return function(){a.off("SpellcheckStart SpellcheckEnd",y)}}},u=K(K({},t),{type:"splitbutton",select:function(w){return w===g.get()},fetch:function(w){var y=B.map(k,function(v){return{type:"choiceitem",value:v.data,text:v.text}});w(y)},onItemAction:function(w,y){g.set(y)}});
1<k.length?a.ui.registry.addSplitButton("spellchecker",u):a.ui.registry.addToggleButton("spellchecker",t);a.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",onSetup:function(w){w.setActive(e.get());var y=function(){w.setActive(e.get())};a.on("SpellcheckStart SpellcheckEnd",y);return function(){a.off("SpellcheckStart SpellcheckEnd",y)}},onAction:n})}},sa=function(a,b,e,d,g,q,k,n){var t=[],u=e.get().suggestions[k];B.each(u,function(w){t.push({text:w,onAction:function(){a.insertContent(a.dom.encode(w));
a.dom.remove(n);A.checkIfFinished(a,d,g)}})});e.get().hasDictionarySupport&&(t.push({type:"separator"}),t.push({text:"Add to dictionary",onAction:function(){A.addToDictionary(a,b,d,g,q,k,n)}}));t.push.apply(t,[{type:"separator"},{text:"Ignore",onAction:function(){A.ignoreWord(a,d,g,k,n)}},{text:"Ignore all",onAction:function(){A.ignoreWord(a,d,g,k,n,!0)}}]);return t},ta={setup:function(a,b,e,d,g,q){a.ui.registry.addContextMenu("spellchecker",{update:function(k){if("mce-spellchecker-word"===k.className){var n=
A.findSpansByIndex(a,A.getElmIndex(k));if(0<n.length){var t=a.dom.createRng();t.setStartBefore(n[0]);t.setEndAfter(n[n.length-1]);a.selection.setRng(t);return sa(a,b,e,d,g,q,k.getAttribute("data-mce-word"),n)}}else return[]}})}};(function(){T.add("spellchecker",function(a,b){if(!1===ca.hasProPlugin(a)){var e=E(!1),d=E(C.getLanguage(a)),g=E(null),q=E(null);ra.register(a,b,e,g,d,q);ta.setup(a,b,q,e,g,d);oa.register(a,b,e,g,q,d);return na.get(a,e,q,g,d,b)}})})()})(window);